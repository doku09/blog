# ✏️ 학습내용

## 연결예외

### UnknwonHostException
- 호스트를 알 수 없음
- IP,도메인이 존재하지 않는다.

### ConnectException: Connection refused
- 연결이 거절되었다.
- 해당 서버는 연결을 시도하는 포트를 사용하지 않기때문에 TCP 연결을 거절한다.
- IP에 해당하는 서버는 켜져있지만, 사용하는 PORT가 없을때 주로 사용한다.
- 서버 컴퓨터의 OS는 이때 TCP RST(Reset) 라는 패킷을 보내서 연결을 거절한다.

### TCP RST(Reset) 패킷
TCP 연결에 문제가 있다는 뜻이다. 이 패킷을 받으면 받은 대상은 바로 연결을 해제해야 한다.


## 네트워크 예외 - 타임아웃
## 연결 타임아웃
## TCP 소켓 타임아웃 - read 타임아웃
``` java
public static void main(String[] args) throws IOException {
    Socket socket = new Socket("localhost", 12345);
    InputStream input = socket.getInputStream();

    try {
        socket.setSoTimeout(3000); // 타임아웃 시간 설정
        int read = input.read();
        System.out.println("read = " + read);
    } catch (Exception e) {
        e.printStackTrace();
    }

    socket.close();
}
```
기본적으로 `input.read()`는 무한정 대기임 이때 setSoTimeout으로 타임아웃 시간을 설정할 수 있다.

> 외부 서버와 통신하는 경우 반드시 연결 타임아웃 소켓 타임아웃을 지정하자

## 네트워크 예외 - 정상종료
EOF가 발생하면 상대방이 FIN 메시지를 보내면서 소켓 연결을 끊었다는 것이다. 이 경우 소켓에 다른 작업을 하면 안되고, FIN 메시지를 받은 클라이언트도 close()를 호출해서 상대방에게 FIN 메시지를 보내고 소켓 연결을 끊어야한다. (4 way handshake)

1. FIN (서버 -> 클라이언트)
2. ACK (클라이언트 -> 서버)
3. FIN + ACK (클라이언트 -> 서버)
4. ACK (서버 -> 클라이언트)
   
# 💫 학습자료